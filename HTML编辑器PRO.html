<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HTML Editor</title>

    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        font-size: 16px;
        color: #333;
        background-color: #f5f5f5;
      }

      header {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 60px;
        background-color: #007bff;
        color: #fff;
        font-size: 24px;
        font-weight: bold;
      }

      #editor {
        width: 100%;
        height: calc(100vh - 240px);
        border: none;
        outline: none;
        padding: 20px;
        box-sizing: border-box;
      }

      #buttons {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: fixed;
        bottom: 25px;
        right: 25px;
        left: auto;
        width: 50%;
        height: 80px;
        padding: 0 20px;
        background-color: #e6e6e6;
      }

      button {
        font-size: 16px;
        background-color: transparent;
        color: #007bff;
        border: solid 1px #007bff;
        cursor: pointer;
        padding: 10px 25px;
        border-radius: 5px;
      }

      button:hover,
      button:focus {
        background-color: #007bff;
        color: #fff;
        border: solid 1px transparent;
      }

      input[type='file'] {
        display: none;
      }

      .dialog-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
        visibility: hidden;
      }

      .dialog {
        background-color: #fff;
        border-radius: 5px;
        padding: 20px;
        box-shadow: 0px 1px 10px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
      }

      .dialog label {
        margin-bottom: 10px;
      }

      .dialog input[type='text'] {
        padding: 5px;
        border-radius: 3px;
        border: solid 1px #ccc;
        margin-bottom: 10px;
        outline: none;
      }

      .dialog button {
        margin-top: 10px;
        align-self: flex-end;
        margin-left: 10px;
        padding: 5px 15px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
      }

      .dialog button.primary {
        background-color: #007bff;
        color: #fff;
      }

      .dialog button.cancel {
        background-color: #f5f5f5;
        color: #333;
      }

      .dialog button:hover,
      .dialog button:focus {
        opacity: 0.8;
      }
    </style>

    <script>
      function executeCode() {
        const editor = document.getElementById('editor');
        try {
          eval(editor.innerText);
        } catch (e) {
          console.error(e);
        }
      }

      function exportHTML() {
        // 显示文件名输入框
        document.querySelector('.dialog-wrapper').style.visibility = 'visible';
        // 禁止页面滚动
        document.body.style.overflow = 'hidden';
      }

      function loadFile() {
        const input = document.getElementById('import');
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = function () {
          const content = this.result;
          const editor = document.getElementById('editor');
          editor.innerText = content;
        };
        if (file) {
          reader.readAsText(file);
        }
      }

      function saveFile() {
        const editor = document.getElementById('editor');
        const html = editor.innerText;
        const filename =
          document.querySelector('.dialog input[type="text"]').value ||
          'index.html';
        const filetype = 'text/html;charset=utf-8';

        const element = document.createElement('a');
        element.setAttribute('href', 'data:' + filetype + ',' + encodeURIComponent(html));
        element.setAttribute('download', filename);
        element.style.display = 'none';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);

        // 隐藏文件名输入框
        document.querySelector('.dialog-wrapper').style.visibility = 'hidden';
        // 允许页面滚动
        document.body.style.overflow = '';
      }

      function closeDialog() {
        // 隐藏文件名输入框
        document.querySelector('.dialog-wrapper').style.visibility = 'hidden';
        // 允许页面滚动
        document.body.style.overflow = '';
      }

      function clearEditor() {
        const editor = document.getElementById('editor');
        editor.innerText = '';
      }
    </script>
  </head>
  <body>
    <header>HTML Editor</header>
    <div id="editor" contenteditable="true"></div>
    <div id="buttons">
      <label for="import">
        <button>导入文件</button>
      </label>
      <input type="file" id="import" accept=".html, .htm" style="display:none;" onchange="loadFile()">
      <button onclick="exportHTML()">导出文件</button>
      <button onclick="executeCode()">运行代码</button>
      <button onclick="clearEditor()">一键删除</button>
    </div>

    <!-- 文件名输入框对话框 -->
    <div class="dialog-wrapper">
      <div class="dialog">
        <label for="filename">请输文件名：</label>
        <input type="text" id="filename" name="filename" />
        <div>
          <button class="primary" onclick="saveFile()">保存</button>
          <button class="cancel" onclick="closeDialog()">取消</button>
        </div>
      </div>
    </div>
  </body>
</html>
